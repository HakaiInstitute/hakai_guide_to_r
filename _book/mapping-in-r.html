<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Hakai Institute R Stats Guide for Reproducible Analyses</title>
  <meta name="description" content="This is the Hakai Institutes R Guide">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Hakai Institute R Stats Guide for Reproducible Analyses" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/analyst_red.png" />
  <meta property="og:description" content="This is the Hakai Institutes R Guide" />
  <meta name="github-repo" content="HakaiInstitute/hakai_guide_to_r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Hakai Institute R Stats Guide for Reproducible Analyses" />
  
  <meta name="twitter:description" content="This is the Hakai Institutes R Guide" />
  <meta name="twitter:image" content="images/analyst_red.png" />

<meta name="author" content="Brett Johnson">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="version-control-and-collaboration.html">
<link rel="next" href="resources-and-references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.0/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.2/leaflet.js"></script>
<script src="libs/esri-leaflet-2.1.4/esri-leaflet-prod.js"></script>
<script src="libs/esri-leaflet-2.1.4/esri-leaflet-bindings.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Hakai Institute R Stats Guide for Reproducible Analyses</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#filling-in-the-gaps"><i class="fa fa-check"></i><b>1.1</b> Filling in the Gaps</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#tidyverse"><i class="fa fa-check"></i><b>1.2</b> Tidyverse</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#acknowledgements"><i class="fa fa-check"></i><b>1.3</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#contributors"><i class="fa fa-check"></i><b>1.4</b> Contributors</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="general-principles.html"><a href="general-principles.html"><i class="fa fa-check"></i><b>2</b> General Principles</a><ul>
<li class="chapter" data-level="2.1" data-path="general-principles.html"><a href="general-principles.html#reproducible-research"><i class="fa fa-check"></i><b>2.1</b> Reproducible Research</a></li>
<li class="chapter" data-level="2.2" data-path="general-principles.html"><a href="general-principles.html#open-science-collaboration"><i class="fa fa-check"></i><b>2.2</b> Open Science Collaboration</a><ul>
<li class="chapter" data-level="2.2.1" data-path="general-principles.html"><a href="general-principles.html#peer-review"><i class="fa fa-check"></i><b>2.2.1</b> Peer Review</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-analysts-toolbox.html"><a href="data-analysts-toolbox.html"><i class="fa fa-check"></i><b>3</b> Data Analyst’s Toolbox</a><ul>
<li class="chapter" data-level="3.1" data-path="data-analysts-toolbox.html"><a href="data-analysts-toolbox.html#install-r-and-r-studio"><i class="fa fa-check"></i><b>3.1</b> Install R and R Studio</a><ul>
<li class="chapter" data-level="3.1.1" data-path="data-analysts-toolbox.html"><a href="data-analysts-toolbox.html#wet-your-feet"><i class="fa fa-check"></i><b>3.1.1</b> Wet Your Feet</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="intro-to-r.html"><a href="intro-to-r.html"><i class="fa fa-check"></i><b>4</b> Intro to R</a><ul>
<li class="chapter" data-level="4.1" data-path="intro-to-r.html"><a href="intro-to-r.html#primary-resource"><i class="fa fa-check"></i><b>4.1</b> Primary Resource</a></li>
<li class="chapter" data-level="4.2" data-path="intro-to-r.html"><a href="intro-to-r.html#data-transformation"><i class="fa fa-check"></i><b>4.2</b> Data Transformation</a></li>
<li class="chapter" data-level="4.3" data-path="intro-to-r.html"><a href="intro-to-r.html#tidying-your-data"><i class="fa fa-check"></i><b>4.3</b> Tidying Your Data</a></li>
<li class="chapter" data-level="4.4" data-path="intro-to-r.html"><a href="intro-to-r.html#visualizing-data"><i class="fa fa-check"></i><b>4.4</b> Visualizing Data</a></li>
<li class="chapter" data-level="4.5" data-path="intro-to-r.html"><a href="intro-to-r.html#learning-objectives"><i class="fa fa-check"></i><b>4.5</b> Learning Objectives</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="start-your-project.html"><a href="start-your-project.html"><i class="fa fa-check"></i><b>5</b> Start Your Project</a><ul>
<li class="chapter" data-level="5.1" data-path="start-your-project.html"><a href="start-your-project.html#create-a-new-r-studio-project"><i class="fa fa-check"></i><b>5.1</b> Create a new R-Studio Project</a></li>
<li class="chapter" data-level="5.2" data-path="start-your-project.html"><a href="start-your-project.html#file-paths-and-the-working-directory"><i class="fa fa-check"></i><b>5.2</b> File Paths and the Working Directory</a><ul>
<li class="chapter" data-level="5.2.1" data-path="start-your-project.html"><a href="start-your-project.html#the-here-package"><i class="fa fa-check"></i><b>5.2.1</b> The <code>here()</code> package</a></li>
<li class="chapter" data-level="5.2.2" data-path="start-your-project.html"><a href="start-your-project.html#create-folder-structure"><i class="fa fa-check"></i><b>5.2.2</b> Create folder structure</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="start-your-project.html"><a href="start-your-project.html#importing-data"><i class="fa fa-check"></i><b>5.3</b> Importing Data</a><ul>
<li class="chapter" data-level="5.3.1" data-path="start-your-project.html"><a href="start-your-project.html#from-spreadsheets"><i class="fa fa-check"></i><b>5.3.1</b> From spreadsheets</a></li>
<li class="chapter" data-level="5.3.2" data-path="start-your-project.html"><a href="start-your-project.html#from-google-drive"><i class="fa fa-check"></i><b>5.3.2</b> From Google Drive</a></li>
<li class="chapter" data-level="5.3.3" data-path="start-your-project.html"><a href="start-your-project.html#from-hakai-data-portal-api"><i class="fa fa-check"></i><b>5.3.3</b> From Hakai Data Portal API</a></li>
<li class="chapter" data-level="5.3.4" data-path="start-your-project.html"><a href="start-your-project.html#analysis"><i class="fa fa-check"></i><b>5.3.4</b> Analysis</a></li>
<li class="chapter" data-level="5.3.5" data-path="start-your-project.html"><a href="start-your-project.html#communicate"><i class="fa fa-check"></i><b>5.3.5</b> Communicate</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="version-control-and-collaboration.html"><a href="version-control-and-collaboration.html"><i class="fa fa-check"></i><b>6</b> Version Control and Collaboration</a><ul>
<li class="chapter" data-level="6.1" data-path="version-control-and-collaboration.html"><a href="version-control-and-collaboration.html#google-drive"><i class="fa fa-check"></i><b>6.1</b> Google Drive</a><ul>
<li class="chapter" data-level="6.1.1" data-path="version-control-and-collaboration.html"><a href="version-control-and-collaboration.html#version-control"><i class="fa fa-check"></i><b>6.1.1</b> Version Control</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="version-control-and-collaboration.html"><a href="version-control-and-collaboration.html#git-and-github"><i class="fa fa-check"></i><b>6.2</b> Git and GitHUB</a><ul>
<li class="chapter" data-level="6.2.1" data-path="version-control-and-collaboration.html"><a href="version-control-and-collaboration.html#step-by-step-install-gitgithub"><i class="fa fa-check"></i><b>6.2.1</b> Step-by-step Install Git/GitHub</a></li>
<li class="chapter" data-level="6.2.2" data-path="version-control-and-collaboration.html"><a href="version-control-and-collaboration.html#start-an-r-studio-project-under-version-control"><i class="fa fa-check"></i><b>6.2.2</b> Start an R-Studio project under version control</a></li>
<li class="chapter" data-level="6.2.3" data-path="version-control-and-collaboration.html"><a href="version-control-and-collaboration.html#gitkraken"><i class="fa fa-check"></i><b>6.2.3</b> GitKraken</a></li>
<li class="chapter" data-level="6.2.4" data-path="version-control-and-collaboration.html"><a href="version-control-and-collaboration.html#fork-and-pull"><i class="fa fa-check"></i><b>6.2.4</b> Fork and Pull</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="version-control-and-collaboration.html"><a href="version-control-and-collaboration.html#best-practices"><i class="fa fa-check"></i><b>6.3</b> Best Practices</a><ul>
<li class="chapter" data-level="6.3.1" data-path="version-control-and-collaboration.html"><a href="version-control-and-collaboration.html#citing-analyses"><i class="fa fa-check"></i><b>6.3.1</b> Citing analyses</a></li>
<li class="chapter" data-level="6.3.2" data-path="version-control-and-collaboration.html"><a href="version-control-and-collaboration.html#private-v.-public-repos"><i class="fa fa-check"></i><b>6.3.2</b> Private v. public repos</a></li>
<li class="chapter" data-level="6.3.3" data-path="version-control-and-collaboration.html"><a href="version-control-and-collaboration.html#granularity-of-repos"><i class="fa fa-check"></i><b>6.3.3</b> Granularity of repos</a></li>
<li class="chapter" data-level="6.3.4" data-path="version-control-and-collaboration.html"><a href="version-control-and-collaboration.html#code-licensing"><i class="fa fa-check"></i><b>6.3.4</b> Code Licensing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="mapping-in-r.html"><a href="mapping-in-r.html"><i class="fa fa-check"></i><b>7</b> Mapping in R</a><ul>
<li class="chapter" data-level="7.1" data-path="mapping-in-r.html"><a href="mapping-in-r.html#site-maps"><i class="fa fa-check"></i><b>7.1</b> Site Maps</a><ul>
<li class="chapter" data-level="7.1.1" data-path="mapping-in-r.html"><a href="mapping-in-r.html#high-resolution-maps"><i class="fa fa-check"></i><b>7.1.1</b> High Resolution Maps</a></li>
<li class="chapter" data-level="7.1.2" data-path="mapping-in-r.html"><a href="mapping-in-r.html#medium-resolution-pbs-mapping-package"><i class="fa fa-check"></i><b>7.1.2</b> Medium Resolution PBS Mapping Package</a></li>
<li class="chapter" data-level="7.1.3" data-path="mapping-in-r.html"><a href="mapping-in-r.html#low-resolution-pacific-coast-maps"><i class="fa fa-check"></i><b>7.1.3</b> Low Resolution Pacific Coast Maps</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="mapping-in-r.html"><a href="mapping-in-r.html#interactive-maps-with-leaflet"><i class="fa fa-check"></i><b>7.2</b> Interactive Maps with Leaflet</a></li>
<li class="chapter" data-level="7.3" data-path="mapping-in-r.html"><a href="mapping-in-r.html#working-with-other-file-types"><i class="fa fa-check"></i><b>7.3</b> Working with other file types</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="resources-and-references.html"><a href="resources-and-references.html"><i class="fa fa-check"></i><b>8</b> Resources and References</a></li>
<li class="chapter" data-level="9" data-path="glossary-of-terms.html"><a href="glossary-of-terms.html"><i class="fa fa-check"></i><b>9</b> Glossary of Terms</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Hakai Institute R Stats Guide for Reproducible Analyses</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mapping-in-r" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Mapping in R</h1>
<div id="site-maps" class="section level2">
<h2><span class="header-section-number">7.1</span> Site Maps</h2>
<p>Section Contributors:</p>
<ul>
<li>Dr. Daniel Okamoto</li>
<li>Dr. Jenn Burt</li>
<li>Matt Whalen</li>
</ul>
<p>A common task among most field researchers is the need to make a basic site map to describe the location of your sampling. Using Arc GIS is the most common way to produce maps at Hakai and requests can be made to the GIS department, but sometimes a simple solution that could be implemented in R is desired.</p>
<p>For a high resolution map with the resolution needed to see detailed coastline features you can use the following code and shape file. To get this to work on your computer, download the shape file and put it in a R Studio project sub-folder called data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">message =</span> <span class="ot">FALSE</span>, <span class="dt">warning =</span> <span class="ot">FALSE</span>)
###################################################### #
###  Script to make a BC map                       <span class="al">###</span> #
###  Author:  D.K. Okamoto (modified by Jenn Burt) <span class="al">###</span> #
###################################################### #

<span class="co"># Libraries needed to run this code</span>
<span class="kw">library</span>(raster)
<span class="kw">library</span>(maps) 
<span class="kw">library</span>(mapdata)
<span class="kw">library</span>(maptools)
<span class="kw">library</span>(rgeos)
<span class="kw">library</span>(rgdal)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(ggsn)
<span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(here)</code></pre></div>
<div id="high-resolution-maps" class="section level3">
<h3><span class="header-section-number">7.1.1</span> High Resolution Maps</h3>
<p>Download the folder <code>2_Shapefile</code> <a href="https://drive.google.com/drive/folders/1GoEhACuGPGaQxn48ACkSc_qePx29TqC5?usp=sharing">here</a> and put it in a sub-directory of your working directory called <code>data</code>.</p>
<p>This script assumes you are using the <code>here()</code> package in conjunction with R-Studio projects to obviate setting your working directory. See chapter 5 and the sub-section about the here() package to read more.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">############## Make a map with sites ################## 
########## Using high resolution shapefile ################

<span class="co"># To download the required shape file, first create a folder in your working directory called data</span>


BC.shp &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="kw">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;2_Shapefile&quot;</span>, <span class="st">&quot;COAST_TEST2.shp&quot;</span>))</code></pre></div>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;/Users/brett.johnson/Documents/Projects/R-guide/data/2_Shapefile/COAST_TEST2.shp&quot;, layer: &quot;COAST_TEST2&quot;
## with 1 features
## It has 5 fields</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### chose the lat/long extent you want to show
Ncalvert &lt;-<span class="st"> </span><span class="kw">extent</span>(<span class="op">-</span><span class="fl">128.18</span>, <span class="op">-</span><span class="fl">127.94</span>, <span class="fl">51.61</span>, <span class="fl">51.78</span>)

### crop your shapefile polygons to the extent defined
<span class="co"># takes a moment to run (patience grasshopper)</span>
BC.shp2 &lt;-<span class="st"> </span><span class="kw">crop</span>(BC.shp,Ncalvert)

### project and fortify (i.e. turn into a dataframe)
BC.df &lt;-<span class="st"> </span><span class="kw">fortify</span>(BC.shp2)

<span class="co"># (IF DESIRED) Load .csv file with your specific study site lat/longs</span>
<span class="co"># this file is a dataframe with 4 columns: site_name, otterOcc(Y or N), lat, long  </span>
<span class="co"># EXPTsites &lt;- read.csv(&quot;/Users/jennb/Dropbox/Simple_BC_map/EXPTsites.csv&quot;, header = T)</span>

<span class="co"># Jenn graph</span>
<span class="co"># here is where you can see the styles of north arrow (scroll to bottom): http://oswaldosantos.github.io/ggsn/</span>
<span class="co"># the high resolution shape file works well at this scale as it gives lots of the coastline detail</span>
<span class="kw">ggplot</span>()<span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_polygon</span>(<span class="dt">data=</span> BC.df, <span class="kw">aes</span>(<span class="dt">x=</span>long,<span class="dt">y=</span>lat,<span class="dt">group=</span> group),
      <span class="dt">colour=</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="fl">0.1</span>, <span class="dt">fill=</span><span class="st">&#39;grey95&#39;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">128.17</span>, <span class="op">-</span><span class="fl">127.95</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">51.63</span>, <span class="fl">51.772</span>)) <span class="op">+</span>
<span class="st">  </span><span class="co">#geom_point(data=EXPTsites, aes(x=long, y=lat, shape=otter), size=4, colour=&quot;blue&quot;, stroke=1.5)+  #add this to plot site locations</span>
<span class="st">  </span><span class="co">#scale_shape_manual(values=c(21,24))+         #this makes different shapes for otter &quot;yes&quot; and otter &quot;no&quot; sites</span>
<span class="st">  </span><span class="kw">scalebar</span>(BC.df, <span class="dt">dist =</span> <span class="dv">3</span>, <span class="dt">st.size=</span><span class="dv">4</span>, <span class="dt">height=</span><span class="fl">0.01</span>, <span class="dt">dd2km =</span> <span class="ot">TRUE</span>, <span class="dt">model =</span> <span class="st">&#39;WGS84&#39;</span>, <span class="dt">anchor =</span> <span class="kw">c</span>(<span class="dt">x =</span> <span class="op">-</span><span class="fl">127.96</span>, <span class="dt">y =</span> <span class="fl">51.63</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">north</span>(<span class="dt">data =</span> BC.df, <span class="dt">scale =</span> <span class="fl">0.1</span>, <span class="dt">symbol =</span> <span class="dv">3</span>, <span class="dt">anchor=</span> <span class="kw">c</span>(<span class="dt">x =</span> <span class="op">-</span><span class="fl">128.15</span>, <span class="dt">y =</span> <span class="fl">51.775</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.grid.minor =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="ot">NA</span>),
          <span class="dt">panel.grid.major =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="ot">NA</span>),
          <span class="dt">axis.title.y=</span> <span class="kw">element_blank</span>(), <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.text.y=</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>), <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>))</code></pre></div>
<p><img src="Hakai-Institute-R-Stats-Guide-for-Reproducible-Analyses_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### if you want to make a larger Central coast map, just change the extent selected
CCoast &lt;-<span class="st"> </span><span class="kw">extent</span>(<span class="op">-</span><span class="fl">128.48</span>, <span class="op">-</span><span class="fl">127.9</span>, <span class="fl">51.5</span>, <span class="fl">52.1</span>)
<span class="co"># crop the map to the new extent</span>
CC.shp2 &lt;-<span class="st"> </span><span class="kw">crop</span>(BC.shp,CCoast)
<span class="co"># fortify</span>
CC.df &lt;-<span class="st"> </span><span class="kw">fortify</span>(CC.shp2)

<span class="co"># Jenn graph</span>
fig1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>()<span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_polygon</span>(<span class="dt">data=</span> CC.df, <span class="kw">aes</span>(<span class="dt">x=</span>long,<span class="dt">y=</span>lat,<span class="dt">group=</span> group),
      <span class="dt">colour=</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="fl">0.1</span>, <span class="dt">fill=</span><span class="st">&#39;grey85&#39;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">128.5</span>, <span class="op">-</span><span class="fl">127.95</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">51.63</span>, <span class="fl">52.05</span>)) <span class="op">+</span>
<span class="st">  </span><span class="co">#geom_point(data=EXPTsites, aes(x=long, y=lat, shape=otter), size=3.3, colour=&quot;blue&quot;, stroke=1.3)+  #add this to plot site locations</span>
<span class="st">  </span><span class="co">#scale_shape_manual(values=c(21,24))+       #this makes different shapes for otter &quot;yes&quot; and otter &quot;no&quot; sites</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">128.4</span>, <span class="op">-</span><span class="fl">128.2</span>, <span class="op">-</span><span class="fl">128.0</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scalebar</span>(CC.df, <span class="dt">dist =</span> <span class="dv">5</span>, <span class="dt">st.size=</span><span class="fl">3.5</span>, <span class="dt">height=</span><span class="fl">0.014</span>, <span class="dt">dd2km =</span> <span class="ot">TRUE</span>, <span class="dt">model =</span> <span class="st">&#39;WGS84&#39;</span>, <span class="dt">anchor =</span> <span class="kw">c</span>(<span class="dt">x =</span> <span class="op">-</span><span class="fl">128.33</span>, <span class="dt">y =</span> <span class="fl">51.64</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">north</span>(<span class="dt">data =</span> CC.df, <span class="dt">scale =</span> <span class="fl">0.07</span>, <span class="dt">symbol =</span> <span class="dv">3</span>, <span class="dt">anchor=</span> <span class="kw">c</span>(<span class="dt">x =</span> <span class="op">-</span><span class="fl">128.465</span>, <span class="dt">y =</span> <span class="fl">52.056</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.grid.minor =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="ot">NA</span>),
          <span class="dt">panel.grid.major =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="ot">NA</span>),
          <span class="dt">axis.title.y=</span> <span class="kw">element_blank</span>(), <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.text.y=</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>), <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>),
          <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>); fig1</code></pre></div>
<p><img src="Hakai-Institute-R-Stats-Guide-for-Reproducible-Analyses_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#I use this code to export a nice PDF file of specific dimensions.</span>
<span class="kw">cairo_pdf</span>(<span class="st">&quot;Fig1.pdf&quot;</span>, <span class="dt">width=</span><span class="dv">4</span>, <span class="dt">height=</span><span class="dv">5</span>)
<span class="kw">print</span>(fig1)
<span class="kw">dev.off</span>()</code></pre></div>
<pre><code>## quartz_off_screen 
##                 2</code></pre>
</div>
<div id="medium-resolution-pbs-mapping-package" class="section level3">
<h3><span class="header-section-number">7.1.2</span> Medium Resolution PBS Mapping Package</h3>
<p>The Pacific Biological Station in Nanaimo has put together a mapping package that contains some medium resolution files of the Pacific Coast.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">############## Make a map with the sites ################## #
############# Using DFO coastline data file ################

<span class="co">#this is lower resolution than the shapefile above</span>

<span class="kw">library</span>(PBSmapping)

## Plot the map
<span class="kw">data</span>(nepacLLhigh)       <span class="co"># DFO BC Coastline data - high resolution</span>
<span class="kw">plotMap</span>(nepacLLhigh, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">128.52</span>, <span class="op">-</span><span class="fl">127.93</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">51.56</span>, <span class="fl">52.07</span>), <span class="dt">col=</span><span class="st">&quot;grey90&quot;</span>, <span class="dt">bg=</span><span class="st">&quot;white&quot;</span>, <span class="dt">tckMinor =</span> <span class="dv">0</span>,
        <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>, <span class="dt">lwd=</span><span class="fl">0.5</span>)
<span class="kw">box</span>()

<span class="co">#add a scale bar</span>
<span class="kw">map.scale</span>(<span class="dt">x=</span><span class="op">-</span><span class="fl">128.455</span>, <span class="dt">y=</span><span class="fl">51.61</span>, <span class="dt">ratio=</span><span class="ot">FALSE</span>, <span class="dt">relwidth=</span><span class="fl">0.2</span>)</code></pre></div>
<p><img src="Hakai-Institute-R-Stats-Guide-for-Reproducible-Analyses_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># </span>
<span class="co"># # add site points</span>
<span class="co"># points(EXPTsites$long, EXPTsites$lat, cex=1.5, pch=20, size=2)</span></code></pre></div>
</div>
<div id="low-resolution-pacific-coast-maps" class="section level3">
<h3><span class="header-section-number">7.1.3</span> Low Resolution Pacific Coast Maps</h3>
<p>For lower resolution maps to represent larger scales you can use the maps from the <code>maps</code> and <code>mapdata</code> packages.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">############## Pacific Coast Map ##################
################################################### #

<span class="kw">library</span>(maps)
<span class="kw">library</span>(mapdata)

<span class="co">#creata a data file to make a basemap</span>
<span class="co"># this database has a lower resolution (which is fine for large scale map)</span>
m &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&quot;world&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;usa&quot;</span>, <span class="st">&quot;Canada&quot;</span>))

<span class="co">#this database has a way higher resolution</span>
d &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&quot;worldHires&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Canada&quot;</span>, <span class="st">&quot;usa&quot;</span>, <span class="st">&quot;Mexico&quot;</span>))

<span class="co">#make a basic map, all one colour</span>
<span class="co"># play around with xlim and ylim to change the extent</span>
<span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> d, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_map</span>(<span class="st">&quot;conic&quot;</span>, <span class="dt">lat0 =</span> <span class="dv">18</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">210</span>, <span class="dv">237</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">46</span>,<span class="dv">62</span>))</code></pre></div>
<p><img src="Hakai-Institute-R-Stats-Guide-for-Reproducible-Analyses_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Make different colours for Alaska and USA and Canada</span>
## I have tried to figure out how to get the Provinces borders to show, to no avail... if someone else has code for this, share!
<span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> <span class="kw">subset</span>(m, region<span class="op">==</span><span class="st">&quot;Canada&quot;</span>), <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), <span class="dt">fill=</span><span class="st">&quot;grey65&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span>.<span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> <span class="kw">subset</span>(m, region<span class="op">==</span><span class="st">&quot;USA&quot;</span>), <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), <span class="dt">fill=</span><span class="st">&quot;white&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span>.<span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="co">#geom_polygon(data = subset(d, region==&quot;Mexico&quot;), aes(x=long, y = lat, group = group), fill=&quot;white&quot;, colour=&quot;black&quot;, size=.1) +</span>
<span class="st">  </span><span class="kw">coord_map</span>(<span class="st">&quot;conic&quot;</span>, <span class="dt">lat0 =</span> <span class="dv">18</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">195</span>, <span class="dv">238</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">30</span>,<span class="fl">62.5</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
          <span class="dt">panel.grid.major =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>),  <span class="co">#change &quot;grey&quot; to NA to remove</span>
          <span class="dt">axis.title=</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.text=</span> <span class="kw">element_blank</span>(),     
          <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>())</code></pre></div>
<p><img src="Hakai-Institute-R-Stats-Guide-for-Reproducible-Analyses_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># playing with extent and colour</span>
<span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> <span class="kw">subset</span>(d, region<span class="op">==</span><span class="st">&quot;Canada&quot;</span>), <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> <span class="kw">subset</span>(d, region<span class="op">==</span><span class="st">&quot;USA&quot;</span>), <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), <span class="dt">fill=</span><span class="st">&quot;darkgrey&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_map</span>(<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">195</span>, <span class="dv">240</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">45</span>,<span class="dv">65</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="Hakai-Institute-R-Stats-Guide-for-Reproducible-Analyses_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># here you can see that if you use the other dataframe &quot;d&quot; the resolution is much higher. </span>
<span class="co"># this is good for smaller chunks of the BC coast, but less good for a PNW map</span>
<span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> <span class="kw">subset</span>(d, region<span class="op">==</span><span class="st">&quot;Canada&quot;</span>), <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), <span class="dt">fill=</span><span class="st">&quot;darkgrey&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span>.<span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> <span class="kw">subset</span>(d, region<span class="op">==</span><span class="st">&quot;USA&quot;</span>), <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), <span class="dt">fill=</span><span class="st">&quot;white&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span>.<span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="co">#geom_polygon(data = subset(d, region==&quot;Mexico&quot;), aes(x=long, y = lat, group = group), fill=&quot;white&quot;, colour=&quot;black&quot;, size=.1) +</span>
<span class="st">  </span><span class="kw">coord_map</span>(<span class="st">&quot;conic&quot;</span>, <span class="dt">lat0 =</span> <span class="dv">18</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">195</span>, <span class="dv">240</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">45</span>,<span class="dv">61</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.minor =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="ot">NA</span>),
          <span class="dt">panel.grid.major =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="ot">NA</span>),
          <span class="dt">axis.title=</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.text=</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>())</code></pre></div>
<p><img src="Hakai-Institute-R-Stats-Guide-for-Reproducible-Analyses_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
</div>
<div id="interactive-maps-with-leaflet" class="section level2">
<h2><span class="header-section-number">7.2</span> Interactive Maps with Leaflet</h2>
<p>It is possible to use the JavaScript based widget known as <a href="https://rstudio.github.io/leaflet/">Leaflet</a> from within R which is great for making interactive maps in an interactive R Markdown document, as well as in Shiny apps. You can use base maps that Hakai hosts from the ArcGIS Online Server (AGOL), or you can use the basic maps that are provided. You are able to add points, visualize heat maps, legends, cloropleths, and other simple GIS tasks.</p>
<p>To do this from R you need to install these packages:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The package that allows you add leaflet map widgets to your interactive web documents:</span>
<span class="kw">install.packages</span>(<span class="st">&#39;leaflet&#39;</span>)

<span class="co"># The package that allows you to use map tiles from Hakai&#39;s AGOL</span>
<span class="kw">install.packages</span>(<span class="st">&#39;leaflet.esri&#39;</span>)</code></pre></div>
<p>Example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(leaflet)
<span class="kw">library</span>(leaflet.esri)
<span class="kw">library</span>(magrittr)
 <span class="kw">leaflet</span>() <span class="op">%&gt;%</span>
<span class="st">        </span><span class="co"># Set the default lat and long and zoom level</span>
<span class="st">        </span><span class="kw">setView</span>(<span class="dt">lng =</span> <span class="op">-</span><span class="dv">126</span>, <span class="dt">lat =</span> <span class="fl">50.3601</span>, <span class="dt">zoom =</span> <span class="dv">7</span>) <span class="op">%&gt;%</span>
<span class="st">        </span><span class="co"># Add default tile</span>
<span class="st">        </span><span class="kw">addTiles</span>() <span class="op">%&gt;%</span>
<span class="st">        </span><span class="co"># Add tile from Hakai AGOL</span>
<span class="st">        </span><span class="kw">addEsriTiledMapLayer</span>(<span class="dt">url =</span> <span class="st">&quot;https://ags.hakai.org:6443/arcgis/rest/services/AGOL_basemaps/Marine_charts/MapServer&quot;</span>)</code></pre></div>
<div id="htmlwidget-c1cdf0c1da871e0c9287" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-c1cdf0c1da871e0c9287">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"setView":[[50.3601,-126],7,[]],"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addEsriTiledMapLayer","args":["https://ags.hakai.org:6443/arcgis/rest/services/AGOL_basemaps/Marine_charts/MapServer",null,null,{"correctZoomLevels":true,"zoomOffsetAllowance":0.1,"useCors":true}]}]},"evals":[],"jsHooks":[]}</script>
<p>Follow the instructions on R-Studio’s <a href="https://rstudio.github.io/leaflet/">Leaflet package webpage</a> to create your map. The included base maps can be viewed <a href="https://leaflet-extras.github.io/leaflet-providers/preview/index.html">here</a></p>
<p>To use the base maps on Hakai’s AGOL server use the <code>addEsriTiledMapLayer()</code> function from the <code>esri.leaflet</code> package where the documentation can be read <a href="https://bhaskarvk.github.io/leaflet.esri/reference/addEsriTiledMapLayer.html">here</a></p>
<p>Hakai ArcGIS Online maps can be viewed <a href="https://ags.hakai.org:6443/arcgis/rest/services/AGOL_basemaps/">here</a>. You can first view any of these base maps in AGOL to decide which you’d like to use. Once you’ve decided, you simply copy the URL and paste it into the <code>addEsriTileMapLayer()</code> function</p>
</div>
<div id="working-with-other-file-types" class="section level2">
<h2><span class="header-section-number">7.3</span> Working with other file types</h2>
<p>You can work with almost any georeferenced file in R. Here’s an example in which use google drive to access a GeoTIFF of Calvert Island generated by the Hakai Geospatial Team, then plot locations of Hakai’s Autonomous Reef Monitoring Systems (<a href="http://www.oceanarms.org/" class="uri">http://www.oceanarms.org/</a>)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Author: Matt Whalen</span>

<span class="co"># load additional libraries</span>
<span class="kw">library</span>( googledrive ) <span class="co"># to access GeoTIFF</span>
<span class="kw">library</span>( scales ) <span class="co"># for transparent colors</span>

<span class="co"># read the GeoTIFF using package googledrive</span>
<span class="co"># note: you need to be able to log in to google drive to use this method</span>
temp &lt;-<span class="st"> </span><span class="kw">tempfile</span>( <span class="dt">fileext =</span> <span class="st">&quot;.tif&quot;</span> )
<span class="kw">drive_download</span>( 
  <span class="kw">as_id</span>(<span class="st">&quot;1hj5KpiRGcPF11pM-oMd13LRCL1uG0pCm&quot;</span>), <span class="dt">path =</span> temp, <span class="dt">overwrite =</span> <span class="ot">TRUE</span> )

<span class="co"># use raster package to load the file into R</span>
ras &lt;-<span class="st"> </span><span class="kw">brick</span>( temp )
<span class="co"># warning message suggests the file has &quot;rotation&quot;. Can override this</span>
ras<span class="op">@</span>rotated &lt;-<span class="st"> </span><span class="ot">FALSE</span>

<span class="co"># Either read in a .csv file of your sites with lat and long, or create the dataframe manually as done here.</span>
xy &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
  <span class="dt">x =</span> <span class="kw">c</span>( <span class="op">-</span><span class="fl">128.0946</span>,<span class="op">-</span><span class="fl">128.0739</span>,<span class="op">-</span><span class="fl">128.0714</span>,<span class="op">-</span><span class="fl">128.2643</span>,<span class="op">-</span><span class="fl">128.2370</span>,<span class="op">-</span><span class="fl">128.2542</span>,<span class="op">-</span><span class="fl">128.0091</span>,
         <span class="op">-</span><span class="fl">128.1512</span>,<span class="op">-</span><span class="fl">127.9967</span>,<span class="op">-</span><span class="fl">128.1552</span>,<span class="op">-</span><span class="fl">128.1261</span>,<span class="op">-</span><span class="fl">128.1399</span> ),
  <span class="dt">y =</span> <span class="kw">c</span>( <span class="fl">51.66462</span>,<span class="fl">51.70118</span>,<span class="fl">51.74418</span>,<span class="fl">51.84152</span>,<span class="fl">51.81435</span>,<span class="fl">51.80363</span>,<span class="fl">51.73073</span>,<span class="fl">51.64908</span>,
        <span class="fl">51.73390</span>,<span class="fl">51.64910</span>,<span class="fl">51.68025</span>,<span class="fl">51.66703</span>),
  <span class="dt">habitat =</span> <span class="kw">c</span>( <span class="st">&quot;Macro&quot;</span>,<span class="st">&quot;Barren&quot;</span>,<span class="st">&quot;Barren&quot;</span>,<span class="st">&quot;Nereo&quot;</span>,<span class="st">&quot;Macro&quot;</span>,<span class="st">&quot;Macro&quot;</span>,<span class="st">&quot;Barren&quot;</span>,
               <span class="st">&quot;Macro&quot;</span>,<span class="st">&quot;Barren&quot;</span>,<span class="st">&quot;Nereo&quot;</span>,<span class="st">&quot;Nereo&quot;</span>,<span class="st">&quot;Nereo&quot;</span> )
)

<span class="co"># project coordinates for sites to match geotiff</span>
<span class="co"># identify latitude and longitude to make SpatialPointsDataFrame</span>
<span class="kw">coordinates</span>( xy ) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>)
<span class="co"># give it some kind of coordinate reference system</span>
<span class="kw">proj4string</span>( xy ) &lt;-<span class="st"> </span><span class="kw">CRS</span>(<span class="st">&quot;+proj=longlat +datum=WGS84&quot;</span>)  
<span class="co"># reporject to the CRS of the GeoTIFF raster</span>
res &lt;-<span class="st"> </span><span class="kw">spTransform</span>( xy, ras<span class="op">@</span>crs )

<span class="co"># crop the map to focus on the area that contains all sites</span>
rasc &lt;-<span class="st"> </span><span class="kw">crop</span>( ras, <span class="kw">extent</span>(res)<span class="op">*</span><span class="fl">1.5</span> ) <span class="co"># multiplying by 1.5 gives a buffer</span>

<span class="co"># plot the cropped raster</span>
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))
<span class="kw">plotRGB</span>( rasc, <span class="dt">maxpixels=</span><span class="dv">5000000</span> )

<span class="co"># add points with custom color scheme</span>
cols &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;gray25&quot;</span>,<span class="st">&quot;#5ab4ac&quot;</span>,<span class="st">&quot;#d8b365&quot;</span>)
<span class="kw">points</span>( res, <span class="dt">cex=</span><span class="dv">2</span>, <span class="dt">pch=</span><span class="dv">21</span>, 
        <span class="dt">bg=</span>scales<span class="op">::</span><span class="kw">alpha</span>(cols[<span class="kw">as.numeric</span>(xy<span class="op">$</span>habitat)],<span class="fl">0.7</span>) )  </code></pre></div>
<p><img src="Hakai-Institute-R-Stats-Guide-for-Reproducible-Analyses_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="version-control-and-collaboration.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="resources-and-references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["Hakai-Institute-R-Stats-Guide-for-Reproducible-Analyses.pdf", "Hakai-Institute-R-Stats-Guide-for-Reproducible-Analyses.epub"],
"toc": {
"collapse": "subsection"
},
"toc_depth": 1
});
});
</script>

</body>

</html>
