<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Hakai Institute R Data-Analyst Guide</title>
  <meta name="description" content="A guideline for R analysts; getting started, best practices, and collaboration">
  <meta name="generator" content="bookdown 0.3.18 and GitBook 2.6.7">

  <meta property="og:title" content="Hakai Institute R Data-Analyst Guide" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A guideline for R analysts; getting started, best practices, and collaboration" />
  <meta name="github-repo" content="br-johnson/Hakai-Data-Analyst" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Hakai Institute R Data-Analyst Guide" />
  
  <meta name="twitter:description" content="A guideline for R analysts; getting started, best practices, and collaboration" />
  

<meta name="author" content="Brett Johnson">


<meta name="date" content="2017-05-22">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="guide-for-the-new-r-analysis-developer.html">
<link rel="next" href="collaborate.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="guide-for-the-new-r-analysis-developer.html"><a href="guide-for-the-new-r-analysis-developer.html"><i class="fa fa-check"></i><b>2</b> Guide for the New R Analysis Developer</a></li>
<li class="chapter" data-level="3" data-path="guidelines-for-hakai-data-analysts.html"><a href="guidelines-for-hakai-data-analysts.html"><i class="fa fa-check"></i><b>3</b> Guidelines for Hakai Data Analysts</a><ul>
<li class="chapter" data-level="3.1" data-path="guidelines-for-hakai-data-analysts.html"><a href="guidelines-for-hakai-data-analysts.html#reproducible-research-literate-programming-and-the-open-notebook"><i class="fa fa-check"></i><b>3.1</b> Reproducible Research, Literate Programming, and the Open Notebook</a></li>
<li class="chapter" data-level="3.2" data-path="guidelines-for-hakai-data-analysts.html"><a href="guidelines-for-hakai-data-analysts.html#programming-style-guide"><i class="fa fa-check"></i><b>3.2</b> Programming Style Guide</a></li>
<li class="chapter" data-level="3.3" data-path="guidelines-for-hakai-data-analysts.html"><a href="guidelines-for-hakai-data-analysts.html#example-project"><i class="fa fa-check"></i><b>3.3</b> Example Project</a><ul>
<li class="chapter" data-level="3.3.1" data-path="guidelines-for-hakai-data-analysts.html"><a href="guidelines-for-hakai-data-analysts.html#set-up-a-repo-on-github"><i class="fa fa-check"></i><b>3.3.1</b> Set up a repo on GitHUB</a></li>
<li class="chapter" data-level="3.3.2" data-path="guidelines-for-hakai-data-analysts.html"><a href="guidelines-for-hakai-data-analysts.html#start-a-new-r-studio-project"><i class="fa fa-check"></i><b>3.3.2</b> Start a new R-Studio Project</a></li>
<li class="chapter" data-level="3.3.3" data-path="guidelines-for-hakai-data-analysts.html"><a href="guidelines-for-hakai-data-analysts.html#template-folder-structure"><i class="fa fa-check"></i><b>3.3.3</b> Template Folder Structure</a></li>
<li class="chapter" data-level="3.3.4" data-path="guidelines-for-hakai-data-analysts.html"><a href="guidelines-for-hakai-data-analysts.html#modularize-your-analysis"><i class="fa fa-check"></i><b>3.3.4</b> Modularize your Analysis</a></li>
<li class="chapter" data-level="3.3.5" data-path="guidelines-for-hakai-data-analysts.html"><a href="guidelines-for-hakai-data-analysts.html#pre-process-data"><i class="fa fa-check"></i><b>3.3.5</b> Pre-process Data</a></li>
<li class="chapter" data-level="3.3.6" data-path="guidelines-for-hakai-data-analysts.html"><a href="guidelines-for-hakai-data-analysts.html#import-data"><i class="fa fa-check"></i><b>3.3.6</b> Import data</a></li>
<li class="chapter" data-level="3.3.7" data-path="guidelines-for-hakai-data-analysts.html"><a href="guidelines-for-hakai-data-analysts.html#commit-etc-use-github-flow"><i class="fa fa-check"></i><b>3.3.7</b> Commit, etc… use GitHUB flow</a></li>
<li class="chapter" data-level="3.3.8" data-path="guidelines-for-hakai-data-analysts.html"><a href="guidelines-for-hakai-data-analysts.html#make-plots"><i class="fa fa-check"></i><b>3.3.8</b> Make plots</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="guidelines-for-hakai-data-analysts.html"><a href="guidelines-for-hakai-data-analysts.html#github-best-practices"><i class="fa fa-check"></i><b>3.4</b> GitHUB Best Practices</a><ul>
<li class="chapter" data-level="3.4.1" data-path="guidelines-for-hakai-data-analysts.html"><a href="guidelines-for-hakai-data-analysts.html#github-flow"><i class="fa fa-check"></i><b>3.4.1</b> GitHUB Flow</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="guidelines-for-hakai-data-analysts.html"><a href="guidelines-for-hakai-data-analysts.html#reproducible-research-using-markdown-notebooks-or-other-need-significant-additions-editing-and-contributions-beyond-here"><i class="fa fa-check"></i><b>3.5</b> Reproducible research using markdown, notebooks, or other (Need significant additions, editing, and contributions beyond here)</a></li>
<li class="chapter" data-level="3.6" data-path="guidelines-for-hakai-data-analysts.html"><a href="guidelines-for-hakai-data-analysts.html#collaboration-with-phyton-users"><i class="fa fa-check"></i><b>3.6</b> Collaboration with Phyton users</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="collaborate.html"><a href="collaborate.html"><i class="fa fa-check"></i><b>4</b> Collaborate</a></li>
<li class="chapter" data-level="5" data-path="additional-references-and-resources.html"><a href="additional-references-and-resources.html"><i class="fa fa-check"></i><b>5</b> Additional References and Resources</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Hakai Institute R Data-Analyst Guide</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="guidelines-for-hakai-data-analysts" class="section level1">
<h1><span class="header-section-number">3</span> Guidelines for Hakai Data Analysts</h1>
<div id="reproducible-research-literate-programming-and-the-open-notebook" class="section level2">
<h2><span class="header-section-number">3.1</span> Reproducible Research, Literate Programming, and the Open Notebook</h2>
<p>These three concepts bring together a very modern way of conducting science. These are the benefits of using these methods:</p>
<ul>
<li>They save you work in the long run by being able to reproduce your own analyses after you’ve long forgotten the details of how they were conducted</li>
<li>If you weave a narrative text into your computer code you’ll be able to understand what you were thinking at a later time when you revisit it.</li>
<li>You can easily collaborate</li>
<li>You can show your peers that you have nothing to hide in your analytical methods</li>
<li>You can share your analyses in hopes that others will improve the quality of your analysis by offering their insight.</li>
</ul>
</div>
<div id="programming-style-guide" class="section level2">
<h2><span class="header-section-number">3.2</span> Programming Style Guide</h2>
<p>Using consisten formatting for writing your code, makes it easier for everyone to interpret. We loosely follow <a href="https://google.github.io/styleguide/Rguide.xml">Google’s R Style Guide</a>. This is an excellent place to start. But you can make slight modifications at your discretion, for example; Googles guide recommendeds two space indents for new lines of code within the same function, but I prefer 8. See <a href="https://www.youtube.com/watch?v=MSPKE1y3cyQ">Roger Pengs Coding Standards Video</a> for some excellent suggestions that I mostly adhere to.</p>
</div>
<div id="example-project" class="section level2">
<h2><span class="header-section-number">3.3</span> Example Project</h2>
<p>In this section I will walk you through an example of a project that brings together all the different concepts we’ve been talking about up to this point. This project should serve as an example of how to develop analyses for the Hakai Institute.</p>
<p>I start every new project this way to make things simple. I first create a GitHUB repo, start a new R-Studio project and link it to my GitHUB repo, and then I populate my working directory with a template folder structure that stores the different categories of files I produce from every analysis.</p>
<div id="set-up-a-repo-on-github" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Set up a repo on GitHUB</h3>
<p>From <a href="http://happygitwithr.com/new-github-first.html">Jenny Bryan’s Book</a>:</p>
<p>“Do this once per new project.</p>
<p>Go to <a href="https://github.com" class="uri">https://github.com</a> and make sure you are logged in.</p>
<p>Click green “New repository” button. Or, if you are on your own profile page, click on “Repositories”, then click the green “New” button.</p>
<p>Repository name: myrepo (or whatever you wish) Public YES Initialize this repository with a README</p>
<p>Click the big green button “Create repository.”</p>
<p>Copy the HTTPS clone URL to your clipboard via the green “Clone or Download” button. Or copy the SSH URL if you chose to set up SSH keys.&quot;</p>
</div>
<div id="start-a-new-r-studio-project" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Start a new R-Studio Project</h3>
<p>From <a href="http://happygitwithr.com/new-github-first.html">Jenny Bryan’s Book</a>:</p>
<p>“In RStudio, start a new Project:</p>
<p>File &gt; New Project &gt; Version Control &gt; Git. In the “repository URL” paste the URL of your new GitHub repository. It will be something like this <a href="https://github.com/jennybc/myrepo.git" class="uri">https://github.com/jennybc/myrepo.git</a>. Be intentional about where you create this Project. Suggest you “Open in new session”. Click “Create Project” to create a new directory, which will be all of these things: a directory or “folder” on your computer a Git repository, linked to a remote GitHub repository an RStudio Project</p>
<p>In the absence of other constraints, I suggest that all of your R projects have exactly this set-up.</p>
<p>This should download the README.md file that we created on GitHub in the previous step. Look in RStudio’s file browser pane for the README.md file.&quot;</p>
</div>
<div id="template-folder-structure" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Template Folder Structure</h3>
<p>I keep all files associated with an analysis in a google drive folder, so that I can give collaborators access to RAW data so they can work with it directly. Doing this has advantages, but you must be careful not to edit files directly in Google Drive without committing changes using Git. Doing that risks putting your repo out of sync with your local version. So only ever make changes file stored in your Google Drive via R, and commit changes to them using Git.</p>
<p>I use a default folder structure for every analysis based on the files that are typically produced from every analysis. Using the directory that you created your new R-Studio project, which will also be your working directory, create these sub-folders within the project folder:</p>
<ul>
<li>raw data</li>
<li>processed data</li>
<li>raw scripts</li>
<li>final scripts</li>
<li>exploratory figures</li>
<li>final figures</li>
</ul>
<p>I typically have my project folder set as my working directory and navigate down into the appropriate directory from there to save figures, processed data etc. using this syntax: <code>write.csv(yourfilename, &quot;./processed data/yourfilename.csv&quot;)</code> as an example.</p>
</div>
<div id="modularize-your-analysis" class="section level3">
<h3><span class="header-section-number">3.3.4</span> Modularize your Analysis</h3>
<p>I usually create a series of scripts in any anlaysis, which helps me to modularize the different components of an analysis.</p>
<p>There are several discrete steps you go through when conducting an analysis. Dr. Roger Peng suggests these steps are common to all analyses, and highlighted in bold are the steps that can be modularized in your analysis, by creating different scripts:</p>
<ul>
<li>Define the question</li>
<li>Define the ideal data set</li>
<li>Determine what data you can access</li>
<li>Obtain the data</li>
<li><strong>Clean the data</strong></li>
<li><strong>Exploratory data analysis</strong></li>
<li><strong>Statistical prediction/modeling</strong></li>
<li>Interpret results</li>
<li>Challenge results</li>
<li>Synthesize/write-up results</li>
<li><strong>Create reproducible code</strong></li>
</ul>
</div>
<div id="pre-process-data" class="section level3">
<h3><span class="header-section-number">3.3.5</span> Pre-process Data</h3>
<p>Most often you’re going to want to read in files that are .csv files. These are comma seperated value files and can be produced from excel or google sheets by saving your excel or google sheet file as a .csv file.</p>
<p>The first module of code I produce is a plain .R script to load in my .csv data file and save it in my R environment as a tibble, a type of data frame, using the <code>new_tbl &lt;- read_csv(&quot;filepath&quot;)</code> format. Before you read in a file, you should load the packages that we will be required for every analysis you conduct using the <code>library(tidyverse)</code> function. Note that you should not use the base R function <code>read.csv</code> but rather use the tidyverse function <code>read_csv</code>. The base version will inevitably cause frustration due to incorrect variable class assignement.</p>
<p>Once I have my dataset in my work environment, I’ll make sure that all the variable classes are what I want them to be. Luckily, when <code>read_csv</code> reads in your file, it prints a summary of the name and type of each variable in your dataframe.</p>
<p>I always check:</p>
<ul>
<li>that my Date column has the class ‘date’</li>
<li>that categorical variables are stored as factors</li>
<li>anything that is not a categorical variable is not stored as a factor but rather is numeric, character, or integer for example.</li>
</ul>
<p>One of the most common problems of why you get errors in R is from R assigning incorrect variable classes. Often you want your variable to be of class numeric, or character, but it is assigned as a factor. This is extremely common and can be remedied by coercing your variable class. This will be covered in the section on tidying data.</p>
</div>
<div id="import-data" class="section level3">
<h3><span class="header-section-number">3.3.6</span> Import data</h3>
</div>
<div id="commit-etc-use-github-flow" class="section level3">
<h3><span class="header-section-number">3.3.7</span> Commit, etc… use GitHUB flow</h3>
</div>
<div id="make-plots" class="section level3">
<h3><span class="header-section-number">3.3.8</span> Make plots</h3>
<p>eg. Make R Markdown report?</p>
</div>
</div>
<div id="github-best-practices" class="section level2">
<h2><span class="header-section-number">3.4</span> GitHUB Best Practices</h2>
<div id="github-flow" class="section level3">
<h3><span class="header-section-number">3.4.1</span> GitHUB Flow</h3>
<p>GitHUB Flow is a workflow that should generally be adhered to whether working individually or collaboratively. Some will argue that there’s no such thing as working individually, especially when you consider that you’re constantly collaborating with past you, and future you.</p>
<p>The main concepts of GitHUB Flow are:</p>
<ul>
<li><p><strong>Branching</strong> - This is a core concept in GitHUB and version cntrol in general – The master branch must always remain stable and working. When you create a new branch, you are creating an environment where you can try out new ideas without directly manipulating the stable ‘master’ version of your analysis.</p></li>
<li><p><strong>Commits</strong> - Commits represent significant changes to your branch. I think of them as mini-milestones that add up to your complete analysis. Perhaps you’re mini-milestone is to create a linear model of something. You can work locally and make save files on your computer while working on the linear model like you normally would. When you finish your linear model, this is a good time to make a commit to your branch. You must name each commit, and this should be descriptive. In this case ‘fitted linear model’ would be ideal.</p></li>
<li><p><strong>Pull Requests</strong> - I like to think of pull requests as an opportunity to review and discuss the sum of several commits before they are merged back into the main branch. Something that helped clarify what a pull request is for me, was thinking about the difference between a push (write) request, and a pull (read) request. In the context of a shared repository, a pull request gives everyone that the repo is shared with a change to <em>read</em> your request to consider the sum of your mini-milestones. Pull requests should amount to the completion of a component of your project. See <a href="https://help.github.com/articles/about-pull-requests/">here</a> for more info.</p></li>
<li><p><strong>Issues</strong> - When working ‘individually’, an excellent way to create a TODO list for yourself is to create new ‘Issues’. Again this could be something routine, like ‘filter data to include only sampling events in the morning.’ You can then leave yourself, and potential collaborators, a little note about why you’re doing this which will be preserved in a timeline for future you, or collaborators, to inspect. Each issue in your repo is given a number, and future commits can be labelled ‘fixes issue #45’ and when that commit is wrapped up in a pull-request which is eventually merged to the master branch, the issue will be marked as resolved. When working collaboratively, issues can be created by whomever is reviewing your code, and the issue can be assigned to you to fix.</p></li>
<li><p><strong>Merge</strong> - Once a Pull Request has been sufficiently reviewed, discussed, and tested (deployed), the new code can be merged with the master branch, typically by the team owner, or maintainer.</p></li>
</ul>
<p>See this <a href="https://guides.github.com/introduction/flow/">GitHUB Flow</a> help article for a nice walkthrough with good diagrams.</p>
</div>
</div>
<div id="reproducible-research-using-markdown-notebooks-or-other-need-significant-additions-editing-and-contributions-beyond-here" class="section level2">
<h2><span class="header-section-number">3.5</span> Reproducible research using markdown, notebooks, or other (Need significant additions, editing, and contributions beyond here)</h2>
<p>R Notebooks is a good way to collaborate with other analysts. When using R Notebooks it’s best to set defualts to: You want your YAML header to look something like this: <code>output:   html_notebook: default,    keep_md: TRUE   github_document: default</code></p>
</div>
<div id="collaboration-with-phyton-users" class="section level2">
<h2><span class="header-section-number">3.6</span> Collaboration with Phyton users</h2>
<p>The data analysis files you commit to your repo should include a ‘feather’ table. <a href="https://blog.rstudio.org/2016/03/29/feather/">Feather</a> is data frame format that is readable by both Python and R, and therefore every analysis should produce this type of dataframe to ensure reproducibility for Python users</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="guide-for-the-new-r-analysis-developer.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="collaborate.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
